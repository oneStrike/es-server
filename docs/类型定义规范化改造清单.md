# 类型定义规范化改造清单

## 需要改造的文件列表及迁移项

### apps

- apps/admin-api/src/common/decorators/audit.decorator.ts
  - 迁移：AuditMetadata
  - 目标：apps/admin-api/src/common/decorators/audit.types.ts

### libs/base

- libs/base/src/base.module.ts
  - 迁移：BaseModuleOptions
  - 目标：libs/base/src/base.module.types.ts
- libs/base/src/interceptors/transform.interceptor.ts
  - 迁移：Response<T>
  - 目标：libs/base/src/interceptors/transform.types.ts
- libs/base/src/utils/requestParse.ts
  - 迁移：DeviceInfo, RequestParams, ParsedRequestData
  - 目标：libs/base/src/utils/request-parse.types.ts
- libs/base/src/utils/bytes.ts
  - 迁移：ByteUnit, BytesOptions
  - 目标：libs/base/src/utils/bytes.types.ts
- libs/base/src/modules/auth/auth.strategy.ts
  - 迁移：JwtPayload, ITokenStorageService
  - 目标：libs/base/src/modules/auth/auth.types.ts
- libs/base/src/modules/auth/base-token-storage.service.ts
  - 迁移：TokenType, ITokenEntity, CreateTokenDto, ITokenDelegate
  - 目标：libs/base/src/modules/auth/token-storage.types.ts
- libs/base/src/modules/auth/login-guard.service.ts
  - 迁移：LoginGuardConfig
  - 目标：libs/base/src/modules/auth/login-guard.types.ts
- libs/base/src/modules/captcha/captcha.service.ts
  - 迁移：CaptchaConfig
  - 目标：libs/base/src/modules/captcha/captcha.types.ts
- libs/base/src/decorators/api-doc.decorator.ts
  - 迁移：ApiDocOptions<TModel>
  - 目标：libs/base/src/decorators/api-doc.types.ts
- libs/base/src/config/upload.config.ts
  - 迁移：UploadConfigInterface
  - 目标：libs/base/src/config/upload.types.ts
- libs/base/src/config/aliyun.config.ts
  - 迁移：AliyunConfigInterface
  - 目标：libs/base/src/config/aliyun.types.ts
- libs/base/src/database/prisma.service.ts
  - 迁移：PrismaClientType
  - 目标：libs/base/src/database/prisma.types.ts

### libs/forum

- libs/forum/src/sensitive-word/sensitive-word-detect.service.ts
  - 迁移：MatchedWord, DetectOptions
  - 目标：libs/forum/src/sensitive-word/sensitive-word.types.ts
- libs/forum/src/sensitive-word/sensitive-word-cache.service.ts
  - 迁移：CacheQueryConfig<T>
  - 目标：libs/forum/src/sensitive-word/sensitive-word.types.ts
- libs/forum/src/sensitive-word/utils/fuzzy-matcher.ts
  - 迁移：FuzzyMatchResult
  - 目标：libs/forum/src/sensitive-word/sensitive-word.types.ts
- libs/forum/src/sensitive-word/utils/trie-node.ts
  - 迁移：TrieNode
  - 目标：libs/forum/src/sensitive-word/sensitive-word.types.ts
- libs/forum/src/sensitive-word/utils/ac-automaton.ts
  - 迁移：MatchResult
  - 目标：libs/forum/src/sensitive-word/sensitive-word.types.ts
- libs/forum/src/section/section-permission.service.ts
  - 迁移：Permission
  - 目标：libs/forum/src/section/section-permission.types.ts
- libs/forum/src/reply/dto/forum-reply.dto.ts
  - 迁移：ForumReplySortFieldEnum, ForumReplySortOrderEnum
  - 目标：libs/forum/src/reply/forum-reply.constant.ts

### libs/user

- libs/user/src/growth-event/growth-event.bus.ts
  - 迁移：UserGrowthEventBus
  - 目标：libs/user/src/growth-event/growth-event.types.ts

## 枚举类型改造清单（迁移到 constant 并补充注释）

- libs/user/src/growth-event/growth-event.types.ts
  - UserGrowthEventStatus → libs/user/src/growth-event/growth-event.constant.ts
- libs/forum/src/reply/dto/forum-reply.dto.ts
  - ForumReplySortFieldEnum, ForumReplySortOrderEnum → libs/forum/src/reply/forum-reply.constant.ts
- libs/base/src/modules/logger/types.ts
  - LoggerLevel → libs/base/src/modules/logger/logger.constant.ts
- libs/base/src/enum/base.enum.ts
  - EnablePlatformEnum, ApiTypeEnum, HttpMethodEnum, ContentTypeEnum, GenderEnum, WorkViewPermissionEnum
  - 目标：libs/base/src/base.constant.ts（或拆分至 base/constants 目录）
- libs/base/src/enum/user.enum.ts
  - UserStatusEnum → libs/base/src/user.constant.ts

## 建议的新文件结构与命名规范

- 类型文件：<feature>.types.ts，放在模块根目录或功能子目录（与增长事件 types 文件一致）
- 常量文件：<feature>.constant.ts，统一承载 enum/const
- DTO：保留在 dto/，不迁移
- 全局增强：global.d.ts 保持原位

## 预估改造工作量（量级）

- 文件改动数：24 个
- 类型迁移项：约 40 处
- 枚举迁移项：9 处
- 量级评估：高（涉及跨文件引用调整与导入重排）
