 # CONSENSUS_user-growth-optimization

 ## 明确需求与验收标准

 - 反作弊、审计、规则发放、等级计算与概览接口在高并发场景下更稳且更快
 - 事件消费链路减少 N+1 查询，降低数据库往返次数
 - 审计表查询与归档效率提升，支持定位失败原因
 - 对外 API 与业务语义不变
 - 关键优化点有可衡量的性能收益或可维护性收益

 ## 技术实现方案（概要）

 - 反作弊：批量查询或复用计数结果；配置读取引入缓存与版本刷新
 - 审计：完善索引覆盖；归档使用游标/主键范围；失败原因结构化存储
 - 规则发放：规则与统计查询批量化；事务内缩短只读逻辑
 - 等级计算：缓存等级规则或优化查询路径；统一等级重算入口
 - 概览接口：必要字段索引复核与聚合查询优化

 ## 技术约束与集成方案

 - 仅使用现有技术栈与库
 - 不引入外部队列或跨进程组件
 - 变更遵循现有模块结构与代码风格

 ## 任务边界

 - 不改动业务事件生产语义
 - 不改动外部 API 契约
 - 优先优化数据库访问与可观测性

 ## 未解决项（将作为实施前确认点）

 - 缓存策略与 TTL 的容忍度
 - 失败原因字段的审计表落库方式
 - 索引新增的范围与具体表
