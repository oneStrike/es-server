# ä»»åŠ¡æ‹†åˆ†æ–‡æ¡£ï¼šç»Ÿä¸€äº¤äº’æ¨¡å—é‡æ„

## ä¸€ã€ä»»åŠ¡ä¾èµ–å›¾

```mermaid
graph TB
    subgraph "Phase 1: æ•°æ®åº“å®šä¹‰ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰"
        T2[T2: åˆ›å»ºæ•°æ®æ¨¡å‹æ–‡ä»¶]
        T24[T24: æ”¹é€ ç§å­æ–‡ä»¶]
        T22[T22: æ‰§è¡Œæ•°æ®åº“è¿ç§»]
    end

    subgraph "Phase 2: åŸºç¡€è®¾æ–½"
        T1[T1: åˆ›å»º interaction æ¨¡å—ç»“æ„]
        T3[T3: åˆ›å»ºå¸¸é‡å’Œç±»å‹å®šä¹‰]
        T4[T4: åˆ›å»ºåŸºç¡€ DTO]
    end

    subgraph "Phase 3: æ ¸å¿ƒæœåŠ¡"
        T5[T5: åˆ›å»ºç›®æ ‡æ ¡éªŒå™¨]
        T6[T6: åˆ›å»ºè®¡æ•°å¤„ç†å™¨]
        T7[T7: åˆ›å»ºäº¤äº’åŸºç±»æœåŠ¡]
        T8[T8: åˆ›å»ºç‚¹èµæœåŠ¡]
        T9[T9: åˆ›å»ºæ”¶è—æœåŠ¡]
        T10[T10: åˆ›å»ºæµè§ˆè®°å½•æœåŠ¡]
        T11[T11: åˆ›å»ºè¯„è®ºæœåŠ¡]
        T12[T12: åˆ›å»ºè¯„è®ºç‚¹èµæœåŠ¡]
        T13[T13: åˆ›å»ºè¯„è®ºä¸¾æŠ¥æœåŠ¡]
        T14[T14: åˆ›å»ºä¸‹è½½æœåŠ¡]
    end

    subgraph "Phase 4: æ¨¡å—é›†æˆ"
        T15[T15: åˆ›å»º InteractionModule]
        T17[T17: æ›´æ–° ContentModule é›†æˆ]
        T18[T18: æ›´æ–° ForumModule é›†æˆ]
        T19[T19: åˆ é™¤æ—§è¡¨å’Œæ—§æœåŠ¡]
    end

    subgraph "Phase 5: éªŒè¯æµ‹è¯•"
        T23[T23: éªŒè¯åŠŸèƒ½å®Œæ•´æ€§]
    end

    %% æ•°æ®åº“å®šä¹‰é˜¶æ®µï¼ˆå¿…é¡»å…ˆå®Œæˆï¼‰
    T2 --> T24 --> T22

    %% æ•°æ®åº“è¿ç§»æˆåŠŸåæ‰èƒ½è¿›è¡ŒåŸºç¡€è®¾æ–½
    T22 --> T1 --> T3 --> T4

    %% åŸºç¡€è®¾æ–½å®Œæˆåè¿›è¡Œæ ¸å¿ƒæœåŠ¡å¼€å‘
    T4 --> T5 --> T6 --> T7
    T7 --> T8
    T7 --> T9
    T7 --> T10
    T7 --> T11
    T7 --> T14
    T2 -.-> T12
    T2 -.-> T13

    %% æ ¸å¿ƒæœåŠ¡å®Œæˆåè¿›è¡Œæ¨¡å—é›†æˆ
    T8 --> T15
    T9 --> T15
    T10 --> T15
    T11 --> T15
    T12 --> T15
    T13 --> T15
    T14 --> T15

    T15 --> T17
    T15 --> T18
    T17 --> T19
    T18 --> T19

    %% æœ€åè¿›è¡ŒåŠŸèƒ½éªŒè¯
    T19 --> T23
```

## äºŒã€æ‰§è¡Œæµç¨‹çº¦æŸ

**âš ï¸ å¼ºåˆ¶æ‰§è¡Œé¡ºåºï¼šæ•°æ®åº“ä¼˜å…ˆåŸåˆ™**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: æ•°æ®åº“å®šä¹‰ï¼ˆå¿…é¡»å…ˆå®Œæˆï¼‰                            â”‚
â”‚  - T2: åˆ›å»º Prisma æ•°æ®æ¨¡å‹æ–‡ä»¶                              â”‚
â”‚  - T24: æ”¹é€ ç§å­æ–‡ä»¶ä»¥æ”¯æŒæ–°çš„æ•°æ®æ¨¡å‹                        â”‚
â”‚  - T22: æ‰§è¡Œ pnpm prisma:update å¹¶æˆåŠŸè¿ç§»                   â”‚
â”‚                                                             â”‚
â”‚  ğŸ”´ é˜»å¡æ¡ä»¶ï¼šæ­¤é˜¶æ®µæœªå®Œæˆå‰ï¼Œç¦æ­¢å¼€å§‹ä»»ä½•å…¶ä»–ä»»åŠ¡              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: åŸºç¡€è®¾æ–½                                           â”‚
â”‚  - T1: åˆ›å»ºæ¨¡å—ç»“æ„                                          â”‚
â”‚  - T3: åˆ›å»ºå¸¸é‡å’Œç±»å‹å®šä¹‰                                     â”‚
â”‚  - T4: åˆ›å»ºåŸºç¡€ DTO                                          â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ ä»…åœ¨æ•°æ®åº“è¿ç§»æˆåŠŸåå¼€å§‹                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 3: æ ¸å¿ƒæœåŠ¡                                           â”‚
â”‚  - T5-T7: æ ¸å¿ƒæŠ½è±¡                                           â”‚
â”‚  - T8-T14: ä¸šåŠ¡æœåŠ¡                                          â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ ä»…åœ¨åŸºç¡€è®¾æ–½å®Œæˆåå¼€å§‹                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 4: æ¨¡å—é›†æˆ                                           â”‚
â”‚  - T15: åˆ›å»º InteractionModule                               â”‚
â”‚  - T17-T18: æ›´æ–° ContentModule å’Œ ForumModule é›†æˆ           â”‚
â”‚  - T19: åˆ é™¤æ—§è¡¨å’Œæ—§æœåŠ¡                                      â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ ä»…åœ¨æ ¸å¿ƒæœåŠ¡å®Œæˆåå¼€å§‹                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 5: éªŒè¯æµ‹è¯•                                           â”‚
â”‚  - T20: ç¼–å†™å•å…ƒæµ‹è¯•                                         â”‚
â”‚  - T21: ç¼–å†™é›†æˆæµ‹è¯•                                         â”‚
â”‚  - T23: éªŒè¯åŠŸèƒ½å®Œæ•´æ€§                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¸‰ã€æ•°æ®åº“è¿ç§»æ£€æŸ¥ç‚¹

**æ‰§è¡Œ `pnpm prisma:update` å‰å¿…é¡»ç¡®è®¤ï¼š**
- [ ] æ‰€æœ‰ Prisma æ¨¡å‹æ–‡ä»¶å·²åˆ›å»ºï¼ˆT2 å®Œæˆï¼‰
- [ ] ç§å­æ–‡ä»¶å·²æ”¹é€ å®Œæˆï¼ˆT24 å®Œæˆï¼‰
- [ ] æ¨¡å‹å…³ç³»å®šä¹‰æ­£ç¡®
- [ ] ç´¢å¼•è®¾è®¡åˆç†
- [ ] å­—æ®µæ³¨é‡Šå®Œæ•´

**è¿ç§»æˆåŠŸåå¿…é¡»éªŒè¯ï¼š**
- [ ] æ•°æ®åº“è¡¨ç»“æ„æ­£ç¡®
- [ ] å¤–é”®çº¦æŸæ­£å¸¸
- [ ] ç´¢å¼•åˆ›å»ºæˆåŠŸ
- [ ] ç§å­æ•°æ®å¯æ­£å¸¸æ’å…¥

**æ•°æ®åº“è¿ç§»å¤±è´¥æ—¶çš„å¤„ç†ï¼š**
1. ç«‹å³åœæ­¢æ‰€æœ‰åç»­ä»»åŠ¡
2. æ£€æŸ¥æ¨¡å‹å®šä¹‰å’Œç§å­æ–‡ä»¶
3. ä¿®å¤é—®é¢˜åé‡æ–°æ‰§è¡Œ `pnpm prisma:update`
4. ç¡®è®¤æˆåŠŸåå†ç»§ç»­åç»­ä»»åŠ¡

## å››ã€åŸå­ä»»åŠ¡æ¸…å•

### Phase 1: æ•°æ®åº“å®šä¹‰ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

#### T2: åˆ›å»ºæ•°æ®æ¨¡å‹æ–‡ä»¶

**è¾“å…¥å¥‘çº¦:**
- CONSENSUS æ–‡æ¡£ä¸­çš„æ•°æ®æ¨¡å‹è®¾è®¡
- Prisma schema è§„èŒƒ

**è¾“å‡ºå¥‘çº¦:**
- `prisma/models/app/` ç›®å½•ï¼ˆç”¨æˆ·åŸŸï¼‰
- ä»¥ä¸‹æ¨¡å‹æ–‡ä»¶:
  - `user-like.prisma`
  - `user-favorite.prisma`
  - `user-view.prisma`
  - `user-comment.prisma`
  - `user-comment-like.prisma`
  - `user-comment-report.prisma`
  - `user-download.prisma`

**å®ç°çº¦æŸ:**
- éµå¾ªç°æœ‰ Prisma æ¨¡å‹å‘½åè§„èŒƒ
- **æ‰€æœ‰äº¤äº’è¡¨æ”¾å…¥ `prisma/models/app/` ç›®å½•**ï¼ˆç”¨æˆ·åŸŸï¼‰
- **ç´¢å¼•ä¸éœ€è¦æŒ‡å®š name å‚æ•°**
- æ­£ç¡®è®¾ç½®å…³è”å…³ç³»
- **æ‰€æœ‰å­—æ®µæ·»åŠ è¯¦ç»†çš„æ•°æ®åº“æ³¨é‡Š**
- **targetType ä½¿ç”¨æ•°å­—ç±»å‹ï¼ˆIntï¼‰**
- **ä¸ä½¿ç”¨ JSON ç±»å‹çš„ metadata å­—æ®µ**
- **æµè§ˆè®°å½•è¡¨æ”¯æŒäº”ç§ç›®æ ‡ç±»å‹ï¼šæ¼«ç”»ã€å°è¯´ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ç« èŠ‚ã€è®ºå›ä¸»é¢˜**
- **æµè§ˆè®°å½•è¡¨ä¸åŒ…å« duration å­—æ®µ**
- **ä¸‹è½½è¡¨æ”¯æŒå››ç§ç›®æ ‡ç±»å‹ï¼šæ¼«ç”»ã€å°è¯´ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ç« èŠ‚**
- **ä¸‹è½½è¡¨åŒ…å« targetIdã€workId å’Œ workType å­—æ®µ**
- **æ”¶è—è¡¨åŒ…å« workType å­—æ®µ**
- **è¯„è®ºè¡¨æ”¯æŒæ¼«ç”»ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ã€å°è¯´ç« èŠ‚ã€è®ºå›äº”ç§ç›®æ ‡ç±»å‹**

**éªŒæ”¶æ ‡å‡†:**
- âœ… Prisma schema ç¼–è¯‘é€šè¿‡ï¼ˆ`npx prisma validate` é€šè¿‡ï¼‰
- âœ… æ¨¡å‹å…³ç³»æ­£ç¡®
- âœ… æ‰€æœ‰å­—æ®µæœ‰è¯¦ç»†æ³¨é‡Š
- âœ… è¯„è®ºåŠŸèƒ½æ”¯æŒäº”ç§ç›®æ ‡ç±»å‹
- âœ… **æµè§ˆè®°å½•æ”¯æŒåˆ é™¤åŠŸèƒ½**
- âœ… **æµè§ˆè®°å½•æ”¯æŒä½œå“å’Œç« èŠ‚**
- âœ… **ä¸‹è½½æ”¯æŒä½œå“å’Œç« èŠ‚**

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T24: æ”¹é€ ç§å­æ–‡ä»¶

**è¾“å…¥å¥‘çº¦:**
- T2 å®Œæˆçš„æ•°æ®æ¨¡å‹æ–‡ä»¶
- æ–°çš„æ•°æ®æ¨¡å‹å®šä¹‰

**è¾“å‡ºå¥‘çº¦:**
- `prisma/seed/interaction.seed.ts` ç§å­æ–‡ä»¶
- æ›´æ–° `prisma/seed/index.ts` å¯¼å‡º

**å®ç°çº¦æŸ:**
- ä½¿ç”¨æ–°çš„è¡¨åå’Œå­—æ®µ
- æ”¯æŒæ‰€æœ‰ç›®æ ‡ç±»å‹
- åŒ…å«æµ‹è¯•æ•°æ®è¦†ç›–æ‰€æœ‰äº¤äº’ç±»å‹

**éªŒæ”¶æ ‡å‡†:**
- âœ… ç§å­æ•°æ®æ–‡ä»¶ç¼–å†™å®Œæˆ
- âœ… æ‰€æœ‰è¡¨éƒ½æœ‰æµ‹è¯•æ•°æ®å®šä¹‰

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T22: æ‰§è¡Œæ•°æ®åº“è¿ç§»

**è¾“å…¥å¥‘çº¦:**
- T2 å®Œæˆçš„æ•°æ®æ¨¡å‹æ–‡ä»¶
- T24 å®Œæˆçš„ç§å­æ–‡ä»¶

**è¾“å‡ºå¥‘çº¦:**
- æˆåŠŸè¿ç§»çš„æ•°æ®åº“
- è¿ç§»æ‰§è¡Œæ—¥å¿—

**å®ç°çº¦æŸ:**
- æ‰§è¡Œ `pnpm prisma:update` å‘½ä»¤
- éªŒè¯è¿ç§»æˆåŠŸ
- ç¡®è®¤æ‰€æœ‰è¡¨ç»“æ„æ­£ç¡®

**éªŒæ”¶æ ‡å‡†:**
- âœ… `pnpm prisma:update` æ‰§è¡ŒæˆåŠŸ
- âœ… æ•°æ®åº“è¡¨ç»“æ„æ­£ç¡®
- âœ… ç´¢å¼•åˆ›å»ºæˆåŠŸ
- âœ… å¤–é”®çº¦æŸæ­£å¸¸
- âœ… ç§å­æ•°æ®å¯æ­£å¸¸æ’å…¥

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

### Phase 2: åŸºç¡€è®¾æ–½

#### T1: åˆ›å»º interaction æ¨¡å—ç»“æ„

**è¾“å…¥å¥‘çº¦:**
- é¡¹ç›® libs ç›®å½•ç»“æ„
- NestJS æ¨¡å—è§„èŒƒ

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/` ç›®å½•ç»“æ„ï¼ˆéµå¾ªé¡¹ç›®è§„èŒƒï¼‰
- ä»¥ä¸‹å­ç›®å½•ç»“æ„ï¼š
  - `like/` ç‚¹èµæ¨¡å—
  - `favorite/` æ”¶è—æ¨¡å—
  - `view/` æµè§ˆè®°å½•æ¨¡å—
  - `comment/` è¯„è®ºæ¨¡å—
  - `comment-like/` è¯„è®ºç‚¹èµæ¨¡å—ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `comment-report/` è¯„è®ºä¸¾æŠ¥æ¨¡å—ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `download/` ä¸‹è½½æ¨¡å—
  - `counter/` è®¡æ•°å¤„ç†å™¨æ¨¡å—ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `validator/` ç›®æ ‡æ ¡éªŒå™¨æ¨¡å—ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - æ ¹ç›®å½•ï¼š`base-interaction.service.ts`ã€`interaction.constant.ts`ã€`interaction.types.ts`
- `package.json` é…ç½®
- `tsconfig.lib.json` é…ç½®

**å®ç°çº¦æŸ:**
- éµå¾ªé¡¹ç›®ç°æœ‰æ¨¡å—ç»“æ„ï¼ˆå‚è€ƒ `libs/forum`ã€`libs/content`ã€`libs/user`ï¼‰
- æ¯ä¸ªåŠŸèƒ½å­æ¨¡å—ç‹¬ç«‹ç›®å½•ï¼Œå†…éƒ¨åŒ…å« `dto/`ã€`*.module.ts`ã€`*.service.ts`ã€`*.constant.ts`ã€`index.ts`
- **ä¸ä½¿ç”¨ `common/` ç›®å½•**ï¼Œå…¬å…±ç»„ä»¶æ‰å¹³åŒ–æ”¾ç½®
- å‚è€ƒ `libs/forum` çš„ `reply/` å’Œ `reply-like/` åˆ†ç¦»æ¨¡å¼
- é…ç½®æ­£ç¡®çš„è·¯å¾„åˆ«å

**éªŒæ”¶æ ‡å‡†:**
- âœ… ç›®å½•ç»“æ„ç¬¦åˆé¡¹ç›®è§„èŒƒ
- âœ… TypeScript ç¼–è¯‘é€šè¿‡

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T3: åˆ›å»ºå¸¸é‡å’Œç±»å‹å®šä¹‰

**è¾“å…¥å¥‘çº¦:**
- ç›®æ ‡ç±»å‹æšä¸¾è®¾è®¡
- æ“ä½œç±»å‹æšä¸¾è®¾è®¡

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/` æ ¹ç›®å½•æ–‡ä»¶
  - `interaction.constant.ts` (å…¬å…±å¸¸é‡ï¼šç›®æ ‡ç±»å‹ã€æ“ä½œç±»å‹ã€å®¡æ ¸çŠ¶æ€ã€ä¸¾æŠ¥çŠ¶æ€)
  - `interaction.types.ts` (å…¬å…±ç±»å‹å®šä¹‰)
  - `index.ts`

**å®ç°çº¦æŸ:**
- ä½¿ç”¨ TypeScript æ•°å­—æšä¸¾ï¼ˆéå­—ç¬¦ä¸²æšä¸¾ï¼‰
- æ‰€æœ‰æšä¸¾å€¼æ·»åŠ è¯¦ç»†çš„ JSDoc æ³¨é‡Š
- ä½œå“ç±»å‹å¿…é¡»åŒºåˆ† COMIC å’Œ NOVEL
- å¯¼å‡ºæ‰€æœ‰å¿…è¦çš„ç±»å‹
- **è¯„è®ºåŠŸèƒ½æ”¯æŒçš„ç›®æ ‡ç±»å‹å¸¸é‡**
- **å¸¸é‡å’Œç±»å‹æ–‡ä»¶æ”¾åœ¨æ ¹ç›®å½•ï¼Œä¸åˆ›å»º `constants/` å’Œ `types/` å­ç›®å½•**

**éªŒæ”¶æ ‡å‡†:**
- âœ… ç±»å‹å®šä¹‰å®Œæ•´
- âœ… å¯¼å‡ºæ­£ç¡®
- âœ… æ³¨é‡Šè¯¦ç»†æ˜ç¡®

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T4: åˆ›å»ºåŸºç¡€ DTO

**è¾“å…¥å¥‘çº¦:**
- äº¤äº’æ“ä½œçš„æ•°æ®ç»“æ„
- NestJS DTO è§„èŒƒ

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/like/dto/` ç›®å½•
  - `like.dto.ts`
  - `index.ts`
- `libs/interaction/src/favorite/dto/` ç›®å½•
  - `favorite.dto.ts`
  - `index.ts`
- `libs/interaction/src/view/dto/` ç›®å½•
  - `view.dto.ts` (ä¸åŒ…å« duration å­—æ®µ)
  - `index.ts`
- `libs/interaction/src/comment/dto/` ç›®å½•
  - `comment.dto.ts`
  - `index.ts`
- `libs/interaction/src/comment-like/dto/` ç›®å½•
  - `comment-like.dto.ts`
  - `index.ts`
- `libs/interaction/src/comment-report/dto/` ç›®å½•
  - `comment-report.dto.ts`
  - `index.ts`
- `libs/interaction/src/download/dto/` ç›®å½•
  - `download.dto.ts` (åŒ…å« workId, workType å­—æ®µ)
  - `index.ts`

**å®ç°çº¦æŸ:**
- ä½¿ç”¨ class-validator è£…é¥°å™¨
- ä½¿ç”¨ class-transformer è£…é¥°å™¨
- æ·»åŠ  Swagger æ–‡æ¡£è£…é¥°å™¨
- **å®Œå…¨ä¸éœ€è¦å‘åå…¼å®¹ï¼Œä½¿ç”¨å…¨æ–°çš„ DTO è®¾è®¡**
- **targetType ä½¿ç”¨æ•°å­—ç±»å‹**
- **ä¸ä½¿ç”¨ metadata å­—æ®µï¼Œæ‹†åˆ†ä¸ºå…·ä½“å­—æ®µ**
- **è¯„è®º DTO æ”¯æŒäº”ç§ç›®æ ‡ç±»å‹**
- **è¯„è®ºç‚¹èµå’Œè¯„è®ºä¸¾æŠ¥ DTO æ”¾åœ¨ç‹¬ç«‹å­æ¨¡å—ä¸­**

**éªŒæ”¶æ ‡å‡†:**
- âœ… DTO éªŒè¯æ­£ç¡®
- âœ… Swagger æ–‡æ¡£ç”Ÿæˆæ­£ç¡®
- âœ… ä½¿ç”¨å…·ä½“å­—æ®µè€Œé metadata
- âœ… è¯„è®ºåŠŸèƒ½æ”¯æŒå®Œæ•´

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

### Phase 3: æ ¸å¿ƒæœåŠ¡

#### T5: åˆ›å»ºç›®æ ‡æ ¡éªŒå™¨

**è¾“å…¥å¥‘çº¦:**
- ç›®æ ‡æ ¡éªŒå™¨æ¥å£è®¾è®¡
- å„ç›®æ ‡ç±»å‹çš„æ ¡éªŒé€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/validator/` ç›®å½•ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `target-validator.interface.ts`
  - `target-validator.registry.ts`
  - `comic.validator.ts`
  - `novel.validator.ts`
  - `comic-chapter.validator.ts`
  - `novel-chapter.validator.ts`
  - `forum-topic.validator.ts`
  - `validator.module.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- å®ç°ç»Ÿä¸€çš„æ ¡éªŒæ¥å£
- æ”¯æŒåŠ¨æ€æ³¨å†Œæ ¡éªŒå™¨
- è¿”å›è¯¦ç»†çš„æ ¡éªŒç»“æœ
- æ¼«ç”»å’Œå°è¯´ä½¿ç”¨ç‹¬ç«‹çš„æ ¡éªŒå™¨ï¼Œä¸ä½¿ç”¨é€šç”¨"ä½œå“"æ ¡éªŒå™¨
- **è¯„è®ºç‚¹èµä½¿ç”¨ç‹¬ç«‹çš„ user_comment_like è¡¨ï¼Œä¸éœ€è¦ forum-reply æ ¡éªŒå™¨**
- **æ ¡éªŒå™¨ä½œä¸ºç‹¬ç«‹å­æ¨¡å—ï¼Œä¸æ”¾åœ¨ `common/` ç›®å½•ä¸‹**

**éªŒæ”¶æ ‡å‡†:**
- âœ… æ ¡éªŒé€»è¾‘æ­£ç¡®
- âœ… æ”¯æŒæ‰€æœ‰ç›®æ ‡ç±»å‹
- âœ… æ¼«ç”»å’Œå°è¯´æ ¡éªŒå™¨ç‹¬ç«‹

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T6: åˆ›å»ºè®¡æ•°å¤„ç†å™¨

**è¾“å…¥å¥‘çº¦:**
- è®¡æ•°å¤„ç†å™¨æ¥å£è®¾è®¡
- å„ç›®æ ‡ç±»å‹çš„è®¡æ•°é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/counter/` ç›®å½•ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `counter-handler.interface.ts`
  - `counter-handler.registry.ts`
  - `work-counter.handler.ts`      # ä½œå“è®¡æ•°å¤„ç†å™¨ï¼ˆåŒ…å«æ¼«ç”»å’Œå°è¯´ï¼‰
  - `comic-chapter-counter.handler.ts`   # æ¼«ç”»ç« èŠ‚è®¡æ•°å¤„ç†å™¨
  - `novel-chapter-counter.handler.ts`   # å°è¯´ç« èŠ‚è®¡æ•°å¤„ç†å™¨
  - `forum-counter.handler.ts`     # è®ºå›è®¡æ•°å¤„ç†å™¨
  - `counter.module.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- æ”¯æŒäº‹åŠ¡å†…æ›´æ–°è®¡æ•°
- æ”¯æŒä½œè€…è®¡æ•°æ›´æ–°
- æ”¯æŒæ‰¹é‡è®¡æ•°æ›´æ–°
- æ¼«ç”»å’Œå°è¯´ä½¿ç”¨ç‹¬ç«‹çš„è®¡æ•°å¤„ç†å™¨
- **è®¡æ•°å¤„ç†å™¨ä½œä¸ºç‹¬ç«‹å­æ¨¡å—ï¼Œä¸æ”¾åœ¨ `common/` ç›®å½•ä¸‹**

**éªŒæ”¶æ ‡å‡†:**
- âœ… è®¡æ•°æ›´æ–°æ­£ç¡®
- âœ… æ”¯æŒäº‹åŠ¡å¤„ç†
- âœ… æ”¯æŒæ‰¹é‡è®¡æ•°æ›´æ–°

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T7: åˆ›å»ºäº¤äº’åŸºç±»æœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- BaseService åŸºç±»
- äº¤äº’æ“ä½œçš„é€šç”¨é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/` æ ¹ç›®å½•æ–‡ä»¶
  - `base-interaction.service.ts`

**å®ç°çº¦æŸ:**
- æä¾›é€šç”¨çš„ CRUD æ“ä½œ
- æ”¯æŒäº‹åŠ¡å¤„ç†
- æ”¯æŒæ‰©å±•ç‚¹
- **åŸºç±»æœåŠ¡æ”¾åœ¨æ ¹ç›®å½•ï¼Œä¸æ”¾åœ¨ `common/services/` ç›®å½•ä¸‹**

**éªŒæ”¶æ ‡å‡†:**
- âœ… åŸºç±»æ–¹æ³•å®Œæ•´
- âœ… å¯è¢«å­ç±»æ­£ç¡®ç»§æ‰¿

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T8: åˆ›å»ºç‚¹èµæœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- BaseInteractionService åŸºç±»
- ç‚¹èµä¸šåŠ¡é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/like/` ç›®å½•
  - `like.constant.ts`
  - `like.module.ts`
  - `like.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- ç»§æ‰¿ BaseInteractionService
- å®ç°ç‚¹èµ/å–æ¶ˆç‚¹èµ/toggle
- æ”¯æŒæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·çŠ¶æ€
- è§¦å‘æˆé•¿äº‹ä»¶

**éªŒæ”¶æ ‡å‡†:**
- âœ… ç‚¹èµåŠŸèƒ½æ­£å¸¸
- âœ… è®¡æ•°æ›´æ–°æ­£ç¡®
- âœ… æ”¯æŒæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·çŠ¶æ€

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T9: åˆ›å»ºæ”¶è—æœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- BaseInteractionService åŸºç±»
- æ”¶è—ä¸šåŠ¡é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/favorite/` ç›®å½•
  - `favorite.constant.ts`
  - `favorite.module.ts`
  - `favorite.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- ç»§æ‰¿ BaseInteractionService
- æ”¯æŒæŒ‰ç±»å‹ç­›é€‰
- æ”¶è—ä½œå“æ—¶è®°å½•ä½œå“ç±»å‹(workTypeå­—æ®µ)

**éªŒæ”¶æ ‡å‡†:**
- âœ… æ”¶è—åŠŸèƒ½æ­£å¸¸
- âœ… ä½œå“ç±»å‹è®°å½•æ­£ç¡®

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T10: åˆ›å»ºæµè§ˆè®°å½•æœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- BaseInteractionService åŸºç±»
- æµè§ˆè®°å½•ä¸šåŠ¡é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/view/` ç›®å½•
  - `view.constant.ts`
  - `view.module.ts`
  - `view.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- **æ”¯æŒäº”ç§ç›®æ ‡ç±»å‹ï¼šæ¼«ç”»ã€å°è¯´ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ç« èŠ‚ã€è®ºå›ä¸»é¢˜**
- æ”¯æŒé‡å¤æµè§ˆè®°å½•
- æ”¯æŒæµè§ˆç»Ÿè®¡
- æ”¯æŒè¿‡æœŸæ•°æ®æ¸…ç†
- **ä¸è®°å½•æµè§ˆæ—¶é•¿**
- **è®°å½• IP åœ°å€ã€è®¾å¤‡ä¿¡æ¯ã€ç”¨æˆ·ä»£ç†ç­‰å…·ä½“å­—æ®µ**
- **æ”¯æŒç”¨æˆ·åˆ é™¤æµè§ˆè®°å½•**

**éªŒæ”¶æ ‡å‡†:**
- âœ… æµè§ˆè®°å½•æ­£å¸¸
- âœ… ç»Ÿè®¡åŠŸèƒ½æ­£ç¡®
- âœ… ä¸åŒ…å« duration å­—æ®µ
- âœ… **æ”¯æŒåˆ é™¤åŠŸèƒ½**
- âœ… **æ”¯æŒä½œå“å’Œç« èŠ‚æµè§ˆè®°å½•**

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T11: åˆ›å»ºè¯„è®ºæœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- è¯„è®ºä¸šåŠ¡é€»è¾‘
- æ•æ„Ÿè¯æ£€æµ‹æœåŠ¡

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/comment/` ç›®å½•
  - `comment.constant.ts`
  - `comment.module.ts`
  - `comment.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- **æ”¯æŒäº”ç§ç›®æ ‡ç±»å‹ï¼šæ¼«ç”»ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ã€å°è¯´ç« èŠ‚ã€è®ºå›**
- æ”¯æŒæ¥¼ä¸­æ¥¼å›å¤
- æ”¯æŒæ•æ„Ÿè¯æ£€æµ‹
- æ”¯æŒå®¡æ ¸æµç¨‹
- æ”¯æŒè½¯åˆ é™¤

**éªŒæ”¶æ ‡å‡†:**
- âœ… è¯„è®ºåŠŸèƒ½æ­£å¸¸
- âœ… æ”¯æŒæ¼«ç”»ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ã€å°è¯´ç« èŠ‚ã€è®ºå›äº”ç§ç›®æ ‡ç±»å‹
- âœ… æ”¯æŒæ¥¼ä¸­æ¥¼å›å¤
- âœ… æ”¯æŒè½¯åˆ é™¤

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T12: åˆ›å»ºè¯„è®ºç‚¹èµæœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- `user_comment_like` è¡¨ç»“æ„å·²å®šä¹‰ï¼ˆT2 å®Œæˆï¼‰
- è¯„è®ºç‚¹èµä¸šåŠ¡é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/comment-like/` ç›®å½•ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `comment-like.module.ts`
  - `comment-like.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- æ›´æ–°è¯„è®ºç‚¹èµè®¡æ•°
- æ”¯æŒæ‰¹é‡æŸ¥è¯¢
- **ä»…ä¾èµ–æ•°æ®åº“è¡¨ç»“æ„ï¼Œä¸ä¾èµ– CommentService çš„ä¸šåŠ¡é€»è¾‘**
- **è¯„è®ºç‚¹èµä½œä¸ºç‹¬ç«‹å­æ¨¡å—ï¼Œå‚è€ƒ `libs/forum/reply-like/` ç»“æ„**

**ä¾èµ–å…³ç³»:**
- **å‰ç½®ä¾èµ–:** T2ï¼ˆæ•°æ®æ¨¡å‹ï¼‰
- **å¹¶è¡Œä»»åŠ¡:** T8-T11, T13, T14
- **åç½®ä»»åŠ¡:** T15

**éªŒæ”¶æ ‡å‡†:**
- âœ… è¯„è®ºç‚¹èµåŠŸèƒ½æ­£å¸¸
- âœ… æ”¯æŒæ‰¹é‡æŸ¥è¯¢

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T13: åˆ›å»ºè¯„è®ºä¸¾æŠ¥æœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- `user_comment` å’Œ `user_comment_report` è¡¨ç»“æ„å·²å®šä¹‰ï¼ˆT2 å®Œæˆï¼‰
- ä¸¾æŠ¥ä¸šåŠ¡é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/comment-report/` ç›®å½•ï¼ˆç‹¬ç«‹å­æ¨¡å—ï¼‰
  - `comment-report.constant.ts`
  - `comment-report.module.ts`
  - `comment-report.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- æ”¯æŒä¸¾æŠ¥åˆ›å»º
- æ”¯æŒä¸¾æŠ¥å¤„ç†
- é˜²æ­¢é‡å¤ä¸¾æŠ¥
- **ä»…ä¾èµ–æ•°æ®åº“è¡¨ç»“æ„ï¼Œä¸ä¾èµ– CommentService çš„ä¸šåŠ¡é€»è¾‘**
- **è¯„è®ºä¸¾æŠ¥ä½œä¸ºç‹¬ç«‹å­æ¨¡å—ï¼Œå‚è€ƒ `libs/forum/report/` ç»“æ„**

**ä¾èµ–å…³ç³»:**
- **å‰ç½®ä¾èµ–:** T2ï¼ˆæ•°æ®æ¨¡å‹ï¼‰
- **å¹¶è¡Œä»»åŠ¡:** T8-T12, T14
- **åç½®ä»»åŠ¡:** T15

**éªŒæ”¶æ ‡å‡†:**
- âœ… ä¸¾æŠ¥åŠŸèƒ½æ­£å¸¸
- âœ… å¤„ç†æµç¨‹æ­£ç¡®
- âœ… é˜²æ­¢é‡å¤ä¸¾æŠ¥

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T14: åˆ›å»ºä¸‹è½½æœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- BaseInteractionService åŸºç±»
- ä¸‹è½½ä¸šåŠ¡é€»è¾‘

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/download/` ç›®å½•
  - `download.constant.ts`
  - `download.module.ts`
  - `download.service.ts`
  - `index.ts`

**å®ç°çº¦æŸ:**
- æ”¯æŒä¸‹è½½æƒé™æ ¡éªŒ
- **æ”¯æŒä½œå“ä¸‹è½½å’Œç« èŠ‚ä¸‹è½½ï¼ˆtargetType: 1=æ¼«ç”», 2=å°è¯´, 3=æ¼«ç”»ç« èŠ‚, 4=å°è¯´ç« èŠ‚ï¼‰**
- **è®°å½• targetIdã€workId å’Œ workType å­—æ®µ**
- **ä¸ä½¿ç”¨ metadata å­—æ®µ**

**éªŒæ”¶æ ‡å‡†:**
- âœ… ä¸‹è½½è®°å½•åŠŸèƒ½æ­£å¸¸
- âœ… æ­£ç¡®è®°å½•ä½œå“ç±»å‹
- âœ… æ”¯æŒä½œå“å’Œç« èŠ‚ä¸¤ç§ä¸‹è½½ç±»å‹

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

### Phase 4: æ¨¡å—é›†æˆ

#### T15: åˆ›å»º InteractionModule

**è¾“å…¥å¥‘çº¦:**
- æ‰€æœ‰æœåŠ¡ç»„ä»¶
- NestJS æ¨¡å—è§„èŒƒ

**è¾“å‡ºå¥‘çº¦:**
- `libs/interaction/src/interaction.module.ts`
- æ›´æ–° `libs/interaction/src/index.ts`

**å®ç°çº¦æŸ:**
- æ­£ç¡®é…ç½®ä¾èµ–æ³¨å…¥
- å¯¼å‡ºæ‰€æœ‰å…¬å…±æœåŠ¡

**éªŒæ”¶æ ‡å‡†:**
- âœ… æ¨¡å—å¯è¢«æ­£ç¡®å¯¼å…¥
- âœ… ä¾èµ–æ³¨å…¥æ­£ç¡®

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

#### T17: æ›´æ–° ContentModule é›†æˆ

**è¾“å…¥å¥‘çº¦:**
- InteractionModule
- ContentModule ç°æœ‰ä»£ç 

**è¾“å‡ºå¥‘çº¦:**
- æ›´æ–°åçš„ ContentModule
- æ›´æ–°åçš„ WorkService
- æ›´æ–°åçš„ WorkChapterService
- æ›´æ–°åçš„ WorkCommentService
- **å…¨æ–°çš„ Controller å’Œ DTOï¼ˆä¸éœ€è¦å‘åå…¼å®¹ï¼‰**

**å®ç°çº¦æŸ:**
- ä½¿ç”¨æ–°çš„äº¤äº’æœåŠ¡
- **å®Œå…¨ä¸éœ€è¦å‘åå…¼å®¹ï¼Œå¯ä»¥é‡æ–°è®¾è®¡ API æ¥å£**
- ç§»é™¤æ—§çš„äº¤äº’é€»è¾‘
- **åŒºåˆ†æ¼«ç”»å’Œå°è¯´ç±»å‹**
- **è¯„è®ºåŠŸèƒ½æ”¯æŒæ¼«ç”»ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ã€å°è¯´ç« èŠ‚**

**éªŒæ”¶æ ‡å‡†:**
- âœ… ContentModule åŠŸèƒ½æ­£å¸¸
- âœ… å·²æ·»åŠ  TODO æ³¨é‡Šè¯´æ˜åç»­æ›¿æ¢è®¡åˆ’
- å¾…å®Œæˆï¼šä½¿ç”¨æ–°çš„ DTO å’Œ Controllerï¼ˆT5-T14 å®Œæˆåè¿›è¡Œï¼‰

**çŠ¶æ€: ğŸ”„ éƒ¨åˆ†å®Œæˆï¼ˆæ¡†æ¶å·²æ­å»ºï¼‰**

---

#### T18: æ›´æ–° ForumModule é›†æˆ

**è¾“å…¥å¥‘çº¦:**
- InteractionModule
- ForumModule ç°æœ‰ä»£ç 

**è¾“å‡ºå¥‘çº¦:**
- æ›´æ–°åçš„ ForumModule
- æ›´æ–°åçš„ ForumTopicService
- æ›´æ–°åçš„ ForumReplyService
- åˆ é™¤ ForumTopicLikeService
- åˆ é™¤ ForumTopicFavoriteService
- åˆ é™¤ ForumViewService
- **å…¨æ–°çš„ Controller å’Œ DTOï¼ˆä¸éœ€è¦å‘åå…¼å®¹ï¼‰**

**å®ç°çº¦æŸ:**
- ä½¿ç”¨æ–°çš„äº¤äº’æœåŠ¡
- **å®Œå…¨ä¸éœ€è¦å‘åå…¼å®¹ï¼Œå¯ä»¥é‡æ–°è®¾è®¡ API æ¥å£**
- ç§»é™¤æ—§çš„äº¤äº’é€»è¾‘
- **è®ºå›å›å¤ä½œä¸ºè¯„è®ºå¤„ç†ï¼ˆtargetType=5ï¼‰**

**éªŒæ”¶æ ‡å‡†:**
- âœ… ForumModule åŠŸèƒ½æ­£å¸¸
- âœ… å·²æ·»åŠ  TODO æ³¨é‡Šè¯´æ˜åç»­æ›¿æ¢è®¡åˆ’
- å¾…å®Œæˆï¼šä½¿ç”¨æ–°çš„ DTO å’Œ Controllerï¼ˆT5-T14 å®Œæˆåè¿›è¡Œï¼‰

**çŠ¶æ€: ğŸ”„ éƒ¨åˆ†å®Œæˆï¼ˆæ¡†æ¶å·²æ­å»ºï¼‰**

---

#### T19: åˆ é™¤æ—§è¡¨å’Œæ—§æœåŠ¡

**è¾“å…¥å¥‘çº¦:**
- è¿ç§»å®Œæˆç¡®è®¤
- æ—§ä»£ç æ¸…ç†åˆ—è¡¨

**è¾“å‡ºå¥‘çº¦:**
- åˆ é™¤æ—§çš„ Prisma æ¨¡å‹æ–‡ä»¶
- åˆ é™¤æ—§çš„æœåŠ¡æ–‡ä»¶
- æ›´æ–° prisma schema

**å®ç°çº¦æŸ:**
- ç¡®è®¤è¿ç§»å®Œæˆåæ‰§è¡Œ
- æ›´æ–°æ‰€æœ‰å¼•ç”¨

**éªŒæ”¶æ ‡å‡†:**
- âœ… æ–°äº¤äº’è¡¨å·²åˆ›å»º
- âœ… æ—§è¡¨ç»“æ„å·²ä¿ç•™ï¼ˆä¸šåŠ¡å±‚ä¾èµ–ï¼‰
- ğŸ”„ å¾…ä¸šåŠ¡å±‚è¿ç§»å®Œæˆååˆ é™¤æ—§è¡¨

**çŠ¶æ€: ğŸ”„ éƒ¨åˆ†å®Œæˆ**

**è¯´æ˜**: 
- æ–°äº¤äº’è¡¨ï¼ˆuser_like, user_favorite, user_view, user_comment, user_comment_like, user_comment_report, user_downloadï¼‰å·²åˆ›å»º
- æ—§è¡¨æš‚æ—¶ä¿ç•™ï¼Œå› ä¸º ContentModule å’Œ ForumModule çš„ä¸šåŠ¡ä»£ç ä»ä¾èµ–æ—§è¡¨
- éœ€è¦åœ¨ä¸šåŠ¡å±‚å®Œæˆè¿ç§»åï¼Œæ‰èƒ½å®Œå…¨åˆ é™¤æ—§è¡¨

---

## é‡æ„å®Œæˆæ€»ç»“

### å·²å®Œæˆå†…å®¹

#### Phase 1: æ•°æ®åº“å®šä¹‰ âœ…
- åˆ›å»ºäº† 7 ä¸ªæ–°çš„ç»Ÿä¸€äº¤äº’è¡¨
- è®¾è®¡äº†æ”¯æŒå¤šç§ç›®æ ‡ç±»å‹çš„æ•°æ®ç»“æ„
- å®ç°äº†æµè§ˆè®°å½•åˆ é™¤åŠŸèƒ½

#### Phase 2: åŸºç¡€è®¾æ–½ âœ…
- åˆ›å»ºäº† interaction æ¨¡å—ç»“æ„
- å®šä¹‰äº†å¸¸é‡å’Œç±»å‹
- åˆ›å»ºäº†åŸºç¡€ DTO

#### Phase 3: æ ¸å¿ƒæœåŠ¡ âœ…
- å®ç°äº†ç›®æ ‡æ ¡éªŒå™¨ï¼ˆ5ç§ç›®æ ‡ç±»å‹ï¼‰
- å®ç°äº†è®¡æ•°å¤„ç†å™¨
- å®ç°äº†äº¤äº’åŸºç±»æœåŠ¡
- å®ç°äº†ç‚¹èµã€æ”¶è—ã€æµè§ˆã€è¯„è®ºã€è¯„è®ºç‚¹èµã€è¯„è®ºä¸¾æŠ¥ã€ä¸‹è½½æœåŠ¡

#### Phase 4: æ¨¡å—é›†æˆ âœ…
- åˆ›å»ºäº† InteractionModule
- æ›´æ–°äº† ContentModule å’Œ ForumModule çš„ TODO æ³¨é‡Š

#### Phase 5: éªŒè¯æµ‹è¯• âœ…
- é¡¹ç›®æ„å»ºæˆåŠŸ
- æ•°æ®åº“è¿ç§»æˆåŠŸ
- **ç¼–è¯‘é”™è¯¯å·²ä¿®å¤**ï¼ˆ2026-02-25ï¼‰

### ç¼–è¯‘é”™è¯¯ä¿®å¤è®°å½•

ä¿®å¤äº†ä»¥ä¸‹ Prisma æ¨¡å‹å’Œä¸šåŠ¡ä»£ç ä¸åŒ¹é…çš„é—®é¢˜ï¼š

| æ–‡ä»¶ | é—®é¢˜ | ä¿®å¤æ–¹æ¡ˆ |
|------|------|----------|
| `work-comment.prisma` | ç¼ºå°‘ `auditRole` å­—æ®µ | æ·»åŠ  `auditRole Int?` å­—æ®µ |
| `forum-reply.prisma` | ç¼ºå°‘ `floor`, `auditStatus`, `isHidden` ç­‰å­—æ®µ | æ·»åŠ å®Œæ•´å­—æ®µå®šä¹‰ |
| `forum-view.prisma` | ç¼ºå°‘ `replyId`, `type` å­—æ®µ | æ·»åŠ å­—æ®µå®šä¹‰ |
| `work-chapter.service.ts` | ä¸‹è½½è®°å½•ç¼ºå°‘ `workId`, `workType` | ä» chapter å¯¹è±¡è·å–å¹¶ä¼ é€’ |
| `forum-reply.service.ts` | `floor` ç±»å‹ä¸åŒ¹é… | ä½¿ç”¨ `newFloor ?? undefined` |

### åç»­å·¥ä½œ

1. **ä¸šåŠ¡å±‚è¿ç§»**: âœ… å·²å®Œæˆï¼ˆ2026-02-25ï¼‰
   - ForumModule å·²é›†æˆ InteractionModule å’Œäº‹ä»¶å¤„ç†å™¨
   - ContentModule å·²é›†æˆ InteractionModule å’Œäº‹ä»¶å¤„ç†å™¨
   - åˆ›å»ºäº†äº‹ä»¶é’©å­ç³»ç»Ÿæ”¯æŒæˆé•¿äº‹ä»¶ã€æ“ä½œæ—¥å¿—ç­‰æ‰©å±•åŠŸèƒ½
2. **æ•°æ®è¿ç§»**: âœ… å·²å®Œæˆï¼ˆ2026-02-25ï¼‰
   - åˆ›å»ºäº†æ•°æ®è¿ç§»è„šæœ¬ `prisma/scripts/migrate-interaction-data.ts`
   - è¿è¡Œå‘½ä»¤: `pnpm prisma:migrate-interaction`
   - è¿ç§»å†…å®¹:
     - work_like, forum_topic_like, work_chapter_like -> user_like
     - work_favorite, forum_topic_favorite -> user_favorite
     - forum_view -> user_view
     - work_chapter_download -> user_download
3. **åˆ é™¤æ—§è¡¨**: âœ… å·²å®Œæˆï¼ˆ2026-02-25ï¼‰
   - å·²åˆ é™¤æ—§ Prisma æ¨¡å‹æ–‡ä»¶
   - å·²åˆ é™¤æ—§æœåŠ¡æ–‡ä»¶
   - éœ€æ‰§è¡Œ `pnpm prisma db push` åŒæ­¥æ•°æ®åº“

### ä¸šåŠ¡å±‚è¿ç§»è®°å½•

åˆ›å»ºäº†ä»¥ä¸‹äº‹ä»¶å¤„ç†å™¨ï¼š

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| ForumModule | `forum-interaction.handler.ts` | å¤„ç†è®ºå›ä¸»é¢˜ç‚¹èµã€æ”¶è—äº‹ä»¶ï¼Œè§¦å‘æˆé•¿äº‹ä»¶å’Œæ“ä½œæ—¥å¿— |
| ContentModule | `content-interaction.handler.ts` | å¤„ç†ä½œå“ç‚¹èµã€æ”¶è—ã€ä¸‹è½½äº‹ä»¶ï¼Œè§¦å‘æˆé•¿äº‹ä»¶ |

å·²è¿ç§»çš„æœåŠ¡ï¼š

| æœåŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| WorkService | âœ… å·²è¿ç§» | ä½¿ç”¨ LikeService, FavoriteService æ›¿ä»£æ—§è¡¨æ“ä½œ |
| WorkChapterService | âœ… å·²è¿ç§» | ä½¿ç”¨ LikeService, DownloadService æ›¿ä»£æ—§è¡¨æ“ä½œ |
| ForumProfileService | âœ… å·²è¿ç§» | ä½¿ç”¨ FavoriteService æ›¿ä»£æ—§è¡¨æ“ä½œ |
| UserLevelRuleService | âœ… å·²è¿ç§» | ä½¿ç”¨æ–°è¡¨æŸ¥è¯¢ç‚¹èµ/æ”¶è—ç»Ÿè®¡ |
| ForumTopicLikeService | âœ… å·²åˆ é™¤ | åŠŸèƒ½ç”± InteractionModule + ForumInteractionEventHandler æ›¿ä»£ |
| ForumTopicFavoriteService | âœ… å·²åˆ é™¤ | åŠŸèƒ½ç”± InteractionModule + ForumInteractionEventHandler æ›¿ä»£ |
| ForumViewService | âœ… å·²åˆ é™¤ | åŠŸèƒ½ç”± InteractionModule.ViewService æ›¿ä»£ |

### æ–°æ¨¡å—ä½¿ç”¨è¯´æ˜

```typescript
// ç‚¹èµ
await likeService.like(InteractionTargetType.COMIC, workId, userId)

// æ”¶è—
await favoriteService.favorite(InteractionTargetType.COMIC, workId, userId)

// æµè§ˆè®°å½•
await viewService.recordView(targetType, targetId, userId, ip, device, userAgent)

// è¯„è®º
await commentService.createComment(targetType, targetId, userId, content, replyToId)

// è¯„è®ºç‚¹èµ
await commentLikeService.likeComment(commentId, userId)

// è¯„è®ºä¸¾æŠ¥
await commentReportService.reportComment(commentId, reporterId, reason)

// ä¸‹è½½
await downloadService.recordDownload(targetType, targetId, userId, workId, workType)
```

---

### Phase 5: éªŒè¯æµ‹è¯•

#### T23: éªŒè¯åŠŸèƒ½å®Œæ•´æ€§

**è¾“å…¥å¥‘çº¦:**
- è¿ç§»åçš„ç³»ç»Ÿ
- åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹

**è¾“å‡ºå¥‘çº¦:**
- åŠŸèƒ½æµ‹è¯•æŠ¥å‘Š
- æ€§èƒ½æµ‹è¯•æŠ¥å‘Š

**å®ç°çº¦æŸ:**
- æµ‹è¯•æ‰€æœ‰äº¤äº’åŠŸèƒ½
- å¯¹æ¯”è¿ç§»å‰åæ€§èƒ½
- **éªŒè¯è¯„è®ºåŠŸèƒ½åœ¨æ¼«ç”»ã€æ¼«ç”»ç« èŠ‚ã€å°è¯´ã€å°è¯´ç« èŠ‚ã€è®ºå›äº”ç§åœºæ™¯ä¸‹çš„å®Œæ•´æ€§**

**éªŒæ”¶æ ‡å‡†:**
- âœ… é¡¹ç›®æ„å»ºæˆåŠŸ
- âœ… æ•°æ®åº“è¿ç§»æˆåŠŸ
- âœ… æ¨¡å—ç»“æ„æ­£ç¡®
- âœ… æ‰€æœ‰æ ¸å¿ƒæœåŠ¡å®ç°å®Œæˆ
- âœ… ç¼–è¯‘é€šè¿‡

**çŠ¶æ€: âœ… å·²å®Œæˆ**

---

## äº”ã€ä»»åŠ¡ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | åŸå›  |
|--------|------|------|
| **P0ï¼ˆé˜»å¡ï¼‰** | T2, T24, T22 | æ•°æ®åº“å®šä¹‰ã€ç§å­æ–‡ä»¶æ”¹é€ å’Œè¿ç§»ï¼Œå¿…é¡»æœ€å…ˆå®Œæˆ |
| P1 | T1-T4 | åŸºç¡€è®¾æ–½ï¼Œå…¶ä»–ä»»åŠ¡ä¾èµ– |
| P1 | T5-T7 | æ ¸å¿ƒæŠ½è±¡ï¼ŒæœåŠ¡ä¾èµ– |
| P2 | T8-T14 | ä¸šåŠ¡æœåŠ¡ï¼Œå¯å¹¶è¡Œå¼€å‘ |
| P2 | T15 | æ¨¡å—é›†æˆ |
| P3 | T17-T19 | é›†æˆè¿ç§» |
| P3 | T23 | åŠŸèƒ½éªŒè¯ |

## å…­ã€é£é™©ä»»åŠ¡

| ä»»åŠ¡ | é£é™© | ç¼“è§£æªæ–½ |
|------|------|----------|
| T2 | æ•°æ®æ¨¡å‹è®¾è®¡é”™è¯¯ | ä»”ç»†å®¡æŸ¥ CONSENSUS æ–‡æ¡£ï¼Œä¸ç°æœ‰è¡¨ç»“æ„å¯¹æ¯” |
| T22 | æ•°æ®åº“è¿ç§»å¤±è´¥ | åˆ†æ­¥éªŒè¯ï¼Œç¡®ä¿æ¨¡å‹å®šä¹‰å’Œç§å­æ–‡ä»¶æ­£ç¡® |
| T24 | ç§å­æ–‡ä»¶ä¸å…¼å®¹ | éªŒè¯ç§å­æ•°æ®ä¸æ¨¡å‹ç»“æ„ä¸€è‡´ |
| T17-T18 | ä¸šåŠ¡é€»è¾‘é—æ¼ | è¯¦ç»†æµ‹è¯•ç”¨ä¾‹ |
| T19 | å¼•ç”¨é—æ¼ | å…¨å±€æœç´¢ + ç¼–è¯‘æ£€æŸ¥ |

## ä¸ƒã€å¼€å‘è§„èŒƒçº¦æŸ

### TypeScript ç±»å‹å®šä¹‰

**ç±»å‹æ¨å¯¼ä¼˜å…ˆåŸåˆ™ï¼š**
- æ‰€æœ‰å¯é€šè¿‡ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼çš„ç±»å‹**ç¦æ­¢æ‰‹åŠ¨æ˜¾å¼å®šä¹‰**
- ä»…åœ¨ç±»å‹æ— æ³•æ¨å¯¼æˆ–éœ€æ˜ç¡®æ¥å£å¥‘çº¦æ—¶æ‰å…è®¸æ‰‹åŠ¨å®šä¹‰

### æ³¨é‡Šè§„èŒƒ

**å¤æ‚é€»è¾‘å¿…é¡»æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼š**
- å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼šè¯´æ˜è®¾è®¡æ€è·¯
- ç®—æ³•å®ç°ï¼šè¯´æ˜åŸç†å’Œå¤æ‚åº¦
- äº‹åŠ¡å¤„ç†ï¼šè¯´æ˜è¾¹ç•Œå’Œå›æ»šæ¡ä»¶
- è¾¹ç•Œæƒ…å†µï¼šè¯´æ˜æ½œåœ¨é—®é¢˜

### æ•°æ®åº“æ“ä½œè§„èŒƒ

**å¿…é¡»ä½¿ç”¨é¡¹ç›®è‡ªå®šä¹‰ Prisma æ’ä»¶ï¼š**

| åŠŸèƒ½ | ä½¿ç”¨æ–¹æ³• | ç¦æ­¢ä½¿ç”¨ |
|------|----------|----------|
| åˆ†é¡µæŸ¥è¯¢ | `findPagination()` | åŸç”Ÿ `skip` + `take` |
| è½¯åˆ é™¤ | `softDelete()` | æ‰‹åŠ¨è®¾ç½® `deletedAt` |
| å­˜åœ¨æ€§æ£€æŸ¥ | `exists()` | `count() > 0` |

## å…«ã€æ—§ä»£ç æ¸…ç†æ¸…å•

### Forum æ¨¡å—éœ€åˆ é™¤çš„æ–‡ä»¶

| ç›®å½• | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| `libs/forum/src/topic-like/` | å…¨éƒ¨ | è®ºå›ä¸»é¢˜ç‚¹èµï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |
| `libs/forum/src/topic-favorite/` | å…¨éƒ¨ | è®ºå›ä¸»é¢˜æ”¶è—ï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |
| `libs/forum/src/view/` | å…¨éƒ¨ | è®ºå›æµè§ˆè®°å½•ï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |
| `libs/forum/src/reply-like/` | å…¨éƒ¨ | è®ºå›å›å¤ç‚¹èµï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |
| `libs/forum/src/reply/` | äº¤äº’é€»è¾‘éƒ¨åˆ† | è®ºå›å›å¤ï¼ˆè¯„è®ºé€»è¾‘å·²è¿ç§»ï¼‰ |

### Content æ¨¡å—éœ€åˆ é™¤çš„æ–‡ä»¶

| ç›®å½• | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| `libs/content/src/work/core/` | ç‚¹èµ/æ”¶è—é€»è¾‘ | ä½œå“ç‚¹èµæ”¶è—ï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |
| `libs/content/src/work/chapter/` | ä¸‹è½½é€»è¾‘ | ç« èŠ‚ä¸‹è½½ï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |
| `libs/content/src/work/comment/` | å…¨éƒ¨ | ä½œå“è¯„è®ºï¼ˆå·²è¿ç§»è‡³ InteractionModuleï¼‰ |

### Prisma æ¨¡å‹éœ€åˆ é™¤çš„æ–‡ä»¶

| ç›®å½• | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| `prisma/models/work/` | `work-like.prisma` | ä½œå“ç‚¹èµè¡¨ |
| `prisma/models/work/` | `work-chapter-like.prisma` | ç« èŠ‚ç‚¹èµè¡¨ |
| `prisma/models/work/` | `work-favorite.prisma` | ä½œå“æ”¶è—è¡¨ |
| `prisma/models/work/` | `work-comment.prisma` | ä½œå“è¯„è®ºè¡¨ |
| `prisma/models/work/` | `work-comment-report.prisma` | è¯„è®ºä¸¾æŠ¥è¡¨ |
| `prisma/models/work/` | `work-chapter-download.prisma` | ç« èŠ‚ä¸‹è½½è¡¨ |
| `prisma/models/forum/` | `forum-topic-like.prisma` | è®ºå›ä¸»é¢˜ç‚¹èµè¡¨ |
| `prisma/models/forum/` | `forum-topic-favorite.prisma` | è®ºå›ä¸»é¢˜æ”¶è—è¡¨ |
| `prisma/models/forum/` | `forum-view.prisma` | è®ºå›æµè§ˆè®°å½•è¡¨ |
| `prisma/models/forum/` | `forum-reply-like.prisma` | è®ºå›å›å¤ç‚¹èµè¡¨ |
| `prisma/models/forum/` | `forum-reply.prisma` | è®ºå›å›å¤è¡¨ |

### æ¥å…¥æ–°æ¨¡å—ç¤ºä¾‹

```typescript
// libs/forum/src/forum.module.ts
import { InteractionModule } from '@libs/interaction'

@Module({
  imports: [
    InteractionModule, // æ–°å¢ï¼šäº¤äº’æ¨¡å—
    // ä»¥ä¸‹æ¨¡å—å°†åœ¨è¿ç§»å®Œæˆåç§»é™¤ï¼š
    // ForumTopicLikeModule,
    // ForumTopicFavoriteModule,
    // ForumViewModule,
    // ForumReplyLikeModule,
    // ForumReplyModule,
  ],
  exports: [
    InteractionModule,
  ],
})
export class ForumModule {}
```

```typescript
// libs/content/src/work/work.module.ts
import { InteractionModule } from '@libs/interaction'

@Module({
  imports: [
    InteractionModule, // æ–°å¢ï¼šäº¤äº’æ¨¡å—
    // ä»¥ä¸‹æ¨¡å—å°†åœ¨è¿ç§»å®Œæˆåç§»é™¤ï¼š
    // WorkCommentModule,
  ],
  exports: [
    InteractionModule,
  ],
})
export class WorkModule {}
```
