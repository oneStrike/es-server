# Work 基表与通用关系重构验收清单

## T01 Work 基表与作品类型枚举
- [ ] Prisma schema 能生成 Work 模型与枚举类型
- [ ] Work.type 枚举在基础包对外可用且被正确导出
- [ ] Work 表包含所有公共字段
- [ ] Work 表索引定义正确

## T02 漫画扩展表
- [ ] WorkComic 与 Work 关联完整，旧数据可迁移
- [ ] 原漫画列表/详情查询能通过 Work 过滤且结果一致
- [ ] WorkComic 已移除冗余字段
- [ ] WorkComic 保留漫画特有索引

## T03 小说扩展表
- [ ] Prisma 模型可生成，结构最小可用且可被引用
- [ ] WorkNovel 与 Work 关联正确

## T04 作者/分类/标签关系表
- [ ] 漫画作者/分类/标签可读写，旧数据映射正确
- [ ] WorkAuthorRelation 唯一约束生效
- [ ] WorkCategoryRelation 唯一约束生效
- [ ] WorkTagRelation 唯一约束生效
- [ ] 旧表已删除

## T05 收藏/点赞关系表
- [ ] 漫画收藏/点赞可用且统计正确
- [ ] WorkFavorite 唯一约束生效
- [ ] WorkLike 唯一约束生效
- [ ] AppUser 关联字段更新正确

## T06 通用章节表
- [ ] 章节可通过 workId 查询到所属作品
- [ ] 漫画章节功能与旧逻辑一致
- [ ] workType 字段正确区分作品类型
- [ ] contents 字段存储漫画图片URL数组
- [ ] content 字段预留小说文本内容

## T07 Prisma 生成
- [ ] 生成脚本完成且无类型缺失
- [ ] 新模型在服务层可正确导入

## T08 漫画创建/更新服务
- [ ] 创建接口无字段缺失
- [ ] 更新接口无字段缺失
- [ ] 查询接口无字段缺失
- [ ] 事务内 Work 与 WorkComic 创建顺序正确
- [ ] 枚举类型重命名完成

## T09 漫画列表与详情查询
- [ ] 列表过滤结果与旧逻辑一致
- [ ] 列表排序结果与旧逻辑一致
- [ ] 详情查询返回完整数据

## T10 作者/分类/标签关联逻辑
- [ ] 关联写入与查询结果与旧逻辑一致
- [ ] 关联删除功能正常
- [ ] 关联替换功能正常

## T11 收藏/点赞逻辑
- [ ] 收藏接口无行为变化，数据落入通用表
- [ ] 点赞接口无行为变化，数据落入通用表
- [ ] 统计字段更新正确

## T12 章节服务改造
- [ ] 漫画章节接口行为一致且稳定
- [ ] 小说章节服务预留可用
- [ ] 枚举类型重命名完成

## T13 章节内容服务
- [ ] 章节内容读写可用
- [ ] 上传路径包含 workId 与章节标识
- [ ] DTO 字段从 comicId 更新为 workId

## T14 章节互动表
- [ ] 漫画章节点赞可用且统计正确
- [ ] 漫画章节购买可用且统计正确
- [ ] 漫画章节下载可用且统计正确
- [ ] 数据正确落入通用表，查询结果与旧逻辑一致

## T15 统一评论表
- [ ] 漫画作品评论可用
- [ ] 小说作品评论可用
- [ ] 漫画章节评论可用
- [ ] 小说章节评论可用
- [ ] 评论查询功能正常
- [ ] 评论创建功能正常
- [ ] 评论审核功能正常
- [ ] 评论举报功能正常
- [ ] 用户评论历史可统一查询
- [ ] 枚举类型重命名完成

## T16 管理端与客户端接口
- [ ] 客户端漫画列表接口功能正常
- [ ] 客户端漫画详情接口功能正常
- [ ] 客户端章节列表接口功能正常
- [ ] 客户端章节详情接口功能正常
- [ ] 客户端评论接口功能正常
- [ ] 管理端漫画管理接口功能正常
- [ ] 管理端章节管理接口功能正常
- [ ] 管理端评论管理接口功能正常

## T17 数据迁移
- [ ] 迁移后数据总量与关系正确，无数据丢失
- [ ] 所有接口功能正常，无回归问题
- [ ] 回滚脚本可正常执行，数据可恢复
- [ ] 迁移过程日志完整，可追溯

## T18 测试与质量门禁
- [ ] Prisma 迁移执行成功
- [ ] Prisma 生成执行成功
- [ ] lint 检查通过
- [ ] typecheck 检查通过
- [ ] 现有测试通过
- [ ] 关键接口手工验收通过
