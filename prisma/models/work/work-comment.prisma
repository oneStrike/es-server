/// 作品评论表 - 存储用户对作品的评论信息
model WorkComment {
  /// 主键ID
  id Int @id @default(autoincrement())

  /// 关联的作品ID
  workId Int @map("work_id")
  /// 作品类型：1=漫画, 2=小说
  workType Int @map("work_type")
  /// 关联的章节ID（可选，章节评论时使用）
  chapterId Int? @map("chapter_id")

  /// 评论者ID
  userId Int @map("user_id")

  /// 评论内容
  content String
  /// 楼层号
  floor Int @default(0)
  /// 回复目标ID（楼中楼）
  replyToId Int? @map("reply_to_id")
  /// 实际回复的评论ID（用于楼中楼嵌套）
  actualReplyToId Int? @map("actual_reply_to_id")

  /// 是否隐藏
  isHidden Boolean @default(false) @map("is_hidden")
  /// 审核状态：0=待审核, 1=已通过, 2=已拒绝
  auditStatus Int @default(1) @map("audit_status")
  /// 审核拒绝原因
  auditReason String? @map("audit_reason")
  /// 审核时间
  auditAt DateTime? @map("audit_at") @db.Timestamptz(6)
  /// 审核人ID
  auditById Int? @map("audit_by_id")

  /// 点赞数
  likeCount Int @default(0) @map("like_count")
  /// 敏感词命中记录
  sensitiveWordHits Json? @map("sensitive_word_hits")

  /// 创建时间
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  /// 更新时间
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  /// 软删除时间
  deletedAt DateTime? @map("deleted_at") @db.Timestamptz(6)

  /// 关联作品
  work Work? @relation(fields: [workId], references: [id], onDelete: Cascade)
  /// 关联章节
  chapter WorkChapter? @relation(fields: [chapterId], references: [id], onDelete: Cascade)
  /// 关联用户
  user AppUser @relation(fields: [userId], references: [id])
  /// 回复目标
  replyTo WorkComment? @relation("ReplyTo", fields: [replyToId], references: [id])
  /// 被回复列表
  replies WorkComment[] @relation("ReplyTo")
  /// 实际回复目标
  actualReplyTo WorkComment? @relation("ActualReplyTo", fields: [actualReplyToId], references: [id])
  /// 实际被回复列表
  actualReplies WorkComment[] @relation("ActualReplyTo")
  /// 举报列表
  reports WorkCommentReport[]

  /// 作品索引
  @@index([workId])
  /// 章节索引
  @@index([chapterId])
  /// 用户索引
  @@index([userId])
  /// 审核状态索引
  @@index([auditStatus])
  /// 创建时间索引
  @@index([createdAt])
  /// 删除时间索引
  @@index([deletedAt])
  @@map("work_comment")
}
