/// 论坛回复表 - 存储主题的回复内容，支持多层回复
/// 约束：数据库支持无限层级，但API返回时只展示两层（主题回复 + 一层楼中楼）
model ForumReply {
  /// 主键ID
  id            Int                 @id @default(autoincrement())
  /// 回复内容
  content       String
  /// 关联的主题ID
  topicId       Int                 @map("topic_id")
  /// 关联的论坛用户资料ID
  profileId     Int                 @map("user_id")
  /// 楼层号（直接回复主题的楼层号，楼中楼为null）
  floor         Int?                @map("floor")
  /// 是否隐藏
  isHidden      Boolean             @default(false) @map("is_hidden")
  /// 回复的回复ID（楼中楼，API返回时用于展示层级关系）
  replyToId     Int?                @map("reply_to_id")
  /// 实际回复的回复ID（用于追溯完整回复链，不受层级限制）
  actualReplyToId Int?              @map("actual_reply_to_id")
  /// 审核状态（0=待审核, 1=已通过, 2=已拒绝）
  auditStatus   Int                 @default(0) @map("audit_status") @db.SmallInt
  /// 审核原因
  auditReason   String?             @map("audit_reason") @db.VarChar(500)
  /// 审核时间
  auditAt       DateTime?           @map("audit_at") @db.Timestamptz(6)
  /// 审核人ID
  auditBy       Int?                @map("audit_by")
  /// 点赞数
  likeCount     Int                 @default(0) @map("like_count")
  /// 创建时间
  createdAt     DateTime            @default(now()) @map("created_at") @db.Timestamptz(6)
  /// 更新时间
  updatedAt     DateTime            @updatedAt @map("updated_at") @db.Timestamptz(6)
  /// 软删除时间
  deletedAt     DateTime?           @map("deleted_at") @db.Timestamptz(6)
  /// 版本号（用于乐观锁）
  version       Int                 @default(0)
  replyTo       ForumReply?         @relation("ReplyTo", fields: [replyToId], references: [id])
  replies       ForumReply[]        @relation("ReplyTo")
  actualReplyTo ForumReply?         @relation("ActualReplyTo", fields: [actualReplyToId], references: [id])
  actualReplies ForumReply[]        @relation("ActualReplyTo")
  topic         ForumTopic          @relation(fields: [topicId], references: [id], onDelete: Cascade)
  profile       ForumProfile        @relation(fields: [profileId], references: [id], onDelete: Cascade)
  likes         ForumReplyLike[]
  notifications ForumNotification[] @relation("NotificationReply")

  @@index([topicId])
  @@index([profileId])
  @@index([replyToId])
  @@index([actualReplyToId])
  @@index([floor])
  @@index([isHidden])
  @@index([auditStatus])
  @@index([likeCount])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([deletedAt])
  @@index([topicId, createdAt])
  @@map("forum_reply")
}
