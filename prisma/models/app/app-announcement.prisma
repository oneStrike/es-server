/// 系统公告表 - 存储平台公告、活动公告、维护公告等信息
model AppAnnouncement {
  /// 主键ID
  id Int @id @default(autoincrement())

  /// 关联的页面ID（可选）
  pageId Int? @map("page_id")

  /// 公告标题
  title   String @db.VarChar(100)
  /// 公告内容
  content String
  /// 公告摘要
  summary String? @db.VarChar(500)

  /// 公告类型（0=平台公告, 1=活动公告, 2=维护公告, 3=更新公告, 4=政策公告）
  announcementType Int @default(0) @map("announcement_type") @db.SmallInt
  /// 优先级（数值越大越重要）
  priorityLevel    Int @default(1) @map("priority_level") @db.SmallInt
  /// 是否已发布
  isPublished    Boolean @default(false) @map("is_published")
  /// 是否置顶
  isPinned       Boolean @default(false) @map("is_pinned")
  /// 是否以弹窗形式显示
  showAsPopup    Boolean @default(false) @map("show_as_popup")
  /// 弹窗背景图片URL
  popupBackgroundImage String? @map("popup_background_image") @db.VarChar(200)
  /// 启用的平台列表
  enablePlatform Int[]   @map("enable_platform")
  /// 发布开始时间
  publishStartTime DateTime? @map("publish_start_time") @db.Timestamptz(6)
  /// 发布结束时间
  publishEndTime   DateTime? @map("publish_end_time") @db.Timestamptz(6)
  /// 浏览次数
  viewCount      Int     @default(0) @map("view_count")

  /// 创建时间
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  /// 更新时间
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  /// 关联页面
  appPage            AppPage?              @relation("announcements", fields: [pageId], references: [id])
  /// 阅读记录关联
  announcementReads  AppAnnouncementRead[]

  /// 发布状态与发布时间索引
  @@index([isPublished, publishStartTime, publishEndTime])
  /// 类型与发布状态索引
  @@index([announcementType, isPublished])
  /// 优先级与置顶索引
  @@index([priorityLevel, isPinned])
  /// 创建时间索引
  @@index([createdAt])
  /// 页面索引
  @@index([pageId])
  /// 弹窗与发布状态索引
  @@index([showAsPopup, isPublished])
  @@map("app_announcement")
}
