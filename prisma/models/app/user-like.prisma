/// 用户点赞记录表
/// 记录用户对各类目标（漫画、小说、章节、论坛主题）的点赞操作
/// 支持点赞计数统计和用户点赞状态查询
/// 注意：评论点赞使用独立的 user_comment_like 表
model UserLike {
  /// 主键ID（自增）
  id Int @id @default(autoincrement())

  /// 目标类型
  /// 1=漫画, 2=小说, 3=漫画章节, 4=小说章节, 5=论坛主题
  /// 用于区分点赞对象的具体类型，便于多态查询和统计
  /// 注意：作品必须区分漫画(1)和小说(2)，不能使用通用类型
  targetType Int @map("target_type") @db.SmallInt

  /// 目标ID
  /// 关联的具体目标记录ID
  /// - targetType=1/2 时：work.id
  /// - targetType=3/4 时：work_chapter.id
  /// - targetType=5 时：forum_topic.id
  /// 注意：不使用外键约束，由应用层保证数据一致性
  targetId Int @map("target_id")

  /// 用户ID（关联 app_user.id）
  /// 执行点赞操作的用户
  userId Int @map("user_id")

  /// 创建时间（点赞时间）
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  /// 关联用户
  user AppUser @relation(fields: [userId], references: [id], onDelete: Cascade)

  /// 唯一约束：同一用户对同一目标只能点赞一次
  /// 组合索引确保数据唯一性
  @@unique([targetType, targetId, userId])
  /// 目标类型与目标ID联合索引，用于查询某目标的点赞列表
  @@index([targetType, targetId])
  /// 用户ID索引，用于查询某用户的点赞记录
  @@index([userId])
  /// 创建时间索引，用于按时间排序查询
  @@index([createdAt])
  /// 表名映射
  @@map("user_like")
}
